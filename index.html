<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Alphabet Puzzle</title>
<style>
body { font-family: Arial, sans-serif; padding: 20px; }
table { border-collapse: collapse; width: 100%; text-align: center; font-size: 14px; margin-bottom: 10px; }
th, td { border: 1px solid #aaa; padding: 6px; width: 30px; }
th { background-color: #f4f4f4; }
input { width: 90%; box-sizing: border-box; text-align: center; border: 1px solid #ccc; border-radius: 4px; padding: 3px; }
.pre-filled { background-color: #e0e0e0; font-weight: bold; }
#outputContainer { margin-top: 10px; }
.outputRow { margin-bottom: 20px; }
.outputCell { display: inline-block; width: 20px; text-align: center; position: relative; }
.outputLetter { position: absolute; top: 0; left: 0; width: 100%; }
.outputNumber { position: absolute; bottom: 0; left: 0; width: 100%; font-size: 12px; color: #555; }
button { margin-top: 15px; padding: 6px 12px; border: none; background-color: #2d89ef; color: white; border-radius: 4px; cursor: pointer; }
button:hover { background-color: #1b5fab; }
@media(max-width: 600px) {
  .half-table { display: inline-block; vertical-align: top; }
}
</style>
</head>
<body>

<h2>Alphabet Puzzle</h2>
<p>Enter numbers in the top table. Letters will appear above the numbers in the bottom line.</p>

<div class="half-table">
<table id="puzzleTableTop1">
  <thead><tr id="headerRow1"></tr></thead>
  <tbody><tr id="inputRow1"></tr></tbody>
</table>
</div>
<div class="half-table">
<table id="puzzleTableTop2">
  <thead><tr id="headerRow2"></tr></thead>
  <tbody><tr id="inputRow2"></tr></tbody>
</table>
</div>

<center>
<div id="outputContainer">
  <div class="outputRow" id="outputLine1"></div>
  <div class="outputRow" id="outputLine2"></div>
</div>
</center>

<script>
// Pre-filled top table numbers
const prefilledTop = { "C":2, "H":23, "K":15, "R":24, "Y":25, "Z":1 };
const reservedNumbers = [1, 2, 23, 15, 24, 25]; // numbers not allowed for input

// Top table letters
const alphabet = "ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");

// Bottom sequence: numbers (letters appear when matched)
const bottomSequence = [4,6,null,20,null,2,25,4,6,24,null,23,6,24,13,null,15,6,6,7,null,25,13,5,24,null,24,3,14,15,14,null,20,26,null,1,6,24,13];

// Split alphabet for two tables
const firstHalf = alphabet.slice(0,13);
const secondHalf = alphabet.slice(13);

// Split bottom sequence for two lines
const mid = Math.ceil(bottomSequence.length / 2);
const bottomSeq1 = bottomSequence.slice(0, mid);
const bottomSeq2 = bottomSequence.slice(mid);

// Function to create table
function buildTable(letters, headerRow, inputRow) {
  letters.forEach(letter=>{
    const th = document.createElement("th");
    th.textContent = letter;
    headerRow.appendChild(th);

    const td = document.createElement("td");
    if(prefilledTop[letter] !== undefined){
      td.textContent = prefilledTop[letter];
      td.classList.add("pre-filled");
    } else {
      const input = document.createElement("input");
      input.type = "number";
      input.min="1"; input.max="26";
      input.id = `cell_${letter}`;
      input.addEventListener("change", (e)=>{
        const val = parseInt(e.target.value);
        if(reservedNumbers.includes(val)){
          alert(`Number ${val} is reserved and cannot be used.`);
          e.target.value = "";
        }
        updateOutput();
      });
      td.appendChild(input);
    }
    inputRow.appendChild(td);
  });
}

// Build both top tables
buildTable(firstHalf, document.getElementById("headerRow1"), document.getElementById("inputRow1"));
buildTable(secondHalf, document.getElementById("headerRow2"), document.getElementById("inputRow2"));

// Map number -> letter based on current top table
function getLetterFromNumber(num){
  for(const letter of alphabet){
    const val = prefilledTop[letter] ?? parseInt(document.getElementById(`cell_${letter}`)?.value);
    if(val === num) return letter;
  }
  return "_";
}

// Build bottom line with numbers visible
function buildOutputLine(seq, outputDiv){
  outputDiv.innerHTML = "";
  seq.forEach(n=>{
    const cell = document.createElement("span");
    cell.classList.add("outputCell");

    // Letter above number
    const letterSpan = document.createElement("span");
    letterSpan.classList.add("outputLetter");
    if(n===null) letterSpan.textContent = " ";
    else if(typeof n === "number") letterSpan.textContent = getLetterFromNumber(n);
    else letterSpan.textContent = n; // for letters already given
    cell.appendChild(letterSpan);

    // Number below
    const numberSpan = document.createElement("span");
    numberSpan.classList.add("outputNumber");
    if(n===null) numberSpan.textContent = " ";
    else numberSpan.textContent = n;
    cell.appendChild(numberSpan);

    outputDiv.appendChild(cell);
  });
}

function updateOutput(){
  buildOutputLine(bottomSeq1, document.getElementById("outputLine1"));
  buildOutputLine(bottomSeq2, document.getElementById("outputLine2"));
}

// Initialize bottom line
updateOutput();

// Save inputs
const saveBtn = document.getElementById("saveBtn");
const message = document.getElementById("saveMessage");
saveBtn.addEventListener("click",()=>{
  alphabet.forEach(letter=>{
    const input = document.getElementById(`cell_${letter}`);
    if(input) localStorage.setItem(`cell_${letter}`, input.value);
  });
  message.textContent = "âœ… Saved locally!";
  setTimeout(()=>message.textContent="",2000);
});

// Load saved values
/*
window.addEventListener("load",()=>{
  alphabet.forEach(letter=>{
    const input = document.getElementById(`cell_${letter}`);
    const val = localStorage.getItem(`cell_${letter}`);
    if(val) input.value = val;
  });
  updateOutput();
});*/

window.addEventListener("load",()=>{
  updateOutput();
});

</script>

</body>
</html>

